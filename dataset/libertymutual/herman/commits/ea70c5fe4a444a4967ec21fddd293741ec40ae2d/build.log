[INFO] Error stacktraces are turned on.
[INFO] Scanning for projects...
[WARNING] 
[WARNING] Some problems were encountered while building the effective model for com.libertymutualgroup.herman:herman:atlassian-plugin:1.3.0-SNAPSHOT
[WARNING] 'build.plugins.plugin.version' for org.apache.maven.plugins:maven-jar-plugin is missing. @ line 360, column 15
[WARNING] 
[WARNING] It is highly recommended to fix these problems because they threaten the stability of your build.
[WARNING] 
[WARNING] For this reason, future Maven versions might no longer support building such malformed projects.
[WARNING] 
[INFO] 
[INFO] ----------------< com.libertymutualgroup.herman:herman >----------------
[INFO] Building herman 1.3.0-SNAPSHOT
[INFO] --------------------------[ atlassian-plugin ]--------------------------
[WARNING] Could not transfer metadata org.codehaus.woodstox:stax2-api/maven-metadata.xml from/to codehaus (http://repository.codehaus.org): Transfer failed for http://repository.codehaus.org/org/codehaus/woodstox/stax2-api/maven-metadata.xml
[WARNING] Could not transfer metadata org.codehaus.woodstox:stax2-api/maven-metadata.xml from/to maven (http://repo1.maven.org/maven2): Transfer failed for http://repo1.maven.org/maven2/org/codehaus/woodstox/stax2-api/maven-metadata.xml 501 HTTPS Required
[INFO] 
[INFO] --- jacoco-maven-plugin:0.8.5:prepare-agent (default) @ herman ---
[INFO] argLine set to -javaagent:/home/jdbl/.m2/repository/org/jacoco/org.jacoco.agent/0.8.5/org.jacoco.agent-0.8.5-runtime.jar=destfile=/tmp/tmplnr_nmaz/herman/target/jacoco.exec
[INFO] 
[INFO] --- maven-bamboo-plugin:6.2.11:compress-resources (default-compress-resources) @ herman ---
[WARNING] File encoding has not been set, using platform encoding UTF-8, i.e. build is platform dependent!
[INFO] Compiling javascript using YUI
[INFO] 0 Javascript file(s) were minified into target directory /tmp/tmplnr_nmaz/herman/target/classes
[INFO] 0 CSS file(s) were minified into target directory /tmp/tmplnr_nmaz/herman/target/classes
[INFO] Compressing XML files
[INFO] 2 XML file(s) were minified into target directory /tmp/tmplnr_nmaz/herman/target/classes
[INFO] 
[INFO] --- maven-resources-plugin:3.1.0:resources (default-resources) @ herman ---
[WARNING] Using platform encoding (UTF-8 actually) to copy filtered resources, i.e. build is platform dependent!
[INFO] Copying 24 resources
[INFO] 
[INFO] --- maven-bamboo-plugin:6.2.11:filter-plugin-descriptor (default-filter-plugin-descriptor) @ herman ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] Copying 1 resource
[INFO] 
[INFO] --- maven-compiler-plugin:3.5.1:compile (java-compile) @ herman ---
[INFO] Changes detected - recompiling the module!
[WARNING] File encoding has not been set, using platform encoding UTF-8, i.e. build is platform dependent!
[INFO] Compiling 155 source files to /tmp/tmplnr_nmaz/herman/target/classes
[INFO] /tmp/tmplnr_nmaz/herman/src/main/java/com/libertymutualgroup/herman/aws/ecs/broker/iam/IAMBroker.java: Some input files use or override a deprecated API.
[INFO] /tmp/tmplnr_nmaz/herman/src/main/java/com/libertymutualgroup/herman/aws/ecs/broker/iam/IAMBroker.java: Recompile with -Xlint:deprecation for details.
[INFO] 
[INFO] --- maven-bamboo-plugin:6.2.11:generate-rest-docs (default-generate-rest-docs) @ herman ---
[INFO] 
[INFO] --- maven-resources-plugin:3.1.0:testResources (default-testResources) @ herman ---
[WARNING] Using platform encoding (UTF-8 actually) to copy filtered resources, i.e. build is platform dependent!
[INFO] Copying 14 resources
[INFO] 
[INFO] --- maven-bamboo-plugin:6.2.11:filter-test-plugin-descriptor (default-filter-test-plugin-descriptor) @ herman ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] Copying 1 resource
[INFO] 
[INFO] --- maven-compiler-plugin:3.5.1:testCompile (java-test-compile) @ herman ---
[INFO] Changes detected - recompiling the module!
[WARNING] File encoding has not been set, using platform encoding UTF-8, i.e. build is platform dependent!
[INFO] Compiling 22 source files to /tmp/tmplnr_nmaz/herman/target/test-classes
[INFO] /tmp/tmplnr_nmaz/herman/src/test/java/com/libertymutualgroup/herman/aws/ecs/broker/dynamodb/DynamoDBConfigTest.java: Some input files use or override a deprecated API.
[INFO] /tmp/tmplnr_nmaz/herman/src/test/java/com/libertymutualgroup/herman/aws/ecs/broker/dynamodb/DynamoDBConfigTest.java: Recompile with -Xlint:deprecation for details.
[INFO] /tmp/tmplnr_nmaz/herman/src/test/java/com/libertymutualgroup/herman/aws/ecs/broker/rds/AuroraClientTest.java: Some input files use unchecked or unsafe operations.
[INFO] /tmp/tmplnr_nmaz/herman/src/test/java/com/libertymutualgroup/herman/aws/ecs/broker/rds/AuroraClientTest.java: Recompile with -Xlint:unchecked for details.
[INFO] 
[INFO] --- maven-bamboo-plugin:6.2.11:unit-test (default-unit-test) @ herman ---
[INFO] Surefire report directory: /tmp/tmplnr_nmaz/herman/target/surefire-reports

-------------------------------------------------------
 T E S T S
-------------------------------------------------------
Running com.libertymutualgroup.herman.util.ConfigurationUtilTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 8.518 sec
Running com.libertymutualgroup.herman.util.FileUtilTest
Tests run: 8, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.188 sec
Running com.libertymutualgroup.herman.util.DateUtilTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.143 sec
Running com.libertymutualgroup.herman.cli.command.S3CreateCommandTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.17 sec
Running com.libertymutualgroup.herman.aws.tags.HermanTagTest
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.027 sec
Running com.libertymutualgroup.herman.aws.tags.TagUtilTest
Tests run: 12, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.053 sec
Running com.libertymutualgroup.herman.aws.ecs.EcsDefinitionParserTest
No property file was loaded - we looked for junit.properties
No property file was loaded - we looked for junit.properties
No property file was loaded - we looked for junit.properties
No property file was loaded - we looked for junit.properties
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.293 sec
Running com.libertymutualgroup.herman.aws.ecs.loadbalancing.CertHandlerTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.02 sec
Running com.libertymutualgroup.herman.aws.ecs.loadbalancing.EcsLoadBalancerV2HandlerTest
Updating existing ALB: arn:balancer
... Resetting security groups: sg123456
... Resetting subnets: subnet12345
... Resetting tags
... Modifying target group attributes
... Modifying load balancer attributes:
...    Update: Setting a default idle timeout of 60 seconds
...    Update: Disabling access logging
Updating DNS registration
ALB updates complete: arn:balancer
Creating a new ALB: my-app-dev
... Waiting for ALB create
... ALB state is: active
... Modifying target group attributes
... Modifying load balancer attributes:
...    Update: Setting a default idle timeout of 60 seconds
...    Update: Disabling access logging
Updating DNS registration
ALB updates complete: arn:balancer
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.79 sec
Running com.libertymutualgroup.herman.aws.ecs.loadbalancing.EcsLoadBalancerHandlerTest
Updating ELB: my-app-dev
... Resetting security groups: sg123456
... Resetting subnets: subnet12345
... Resetting tags
... Disabling access logging
... ELB updates complete
... Disabling access logging
... ELB updates complete
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.413 sec
Running com.libertymutualgroup.herman.aws.ecs.EcsClusterIntrospectorTest
Resource: someELBSecurityGroup : sg12345
Resource: someAppSecurityGroup : sg23456
Resource: RDSSecurityGroup : sg34567
Resource: ECSCluster : dev-plat-cluster-WOURKSLUY
Resource: EncryptionKey : 123-123-123-123
Resource: DBSubnetGroup : subnet12345
Resource: InstanceRole : plat-role
Introspection complete:
EcsClusterMetadata{rdsSecurityGroup='sg34567', appSecurityGroup='sg23456', elbSecurityGroups=[sg12345], clusterId='dev-plat-cluster-WOURKSLUY', elbSubnets=[null], publicSubnets=[], privateSubnets=[], clusterCftStackTags=[{Key: Name,Value: some-cluster}], encryptionKey='123-123-123-123', dbSubnetGroup='subnet12345', newrelicOrgTag='Platform', newrelicSbuTag='LMB', newrelicLicenseKey='null', clusterEcsRole='plat-role', vpcId='vpc12345', splunkUrl='null'}
Resource: someELBSecurityGroup : sg12345
Resource: someAppSecurityGroup : sg23456
Resource: RDSSecurityGroup : sg34567
Resource: ECSCluster : dev-plat-cluster-WOURKSLUY
Resource: EncryptionKey : 123-123-123-123
Resource: DBSubnetGroup : subnet12345
Resource: InstanceRole : plat-role
Introspection complete:
EcsClusterMetadata{rdsSecurityGroup='sg34567', appSecurityGroup='sg23456', elbSecurityGroups=[sg12345], clusterId='dev-plat-cluster-WOURKSLUY', elbSubnets=[null], publicSubnets=[], privateSubnets=[], clusterCftStackTags=[{Key: Name,Value: some-cluster}], encryptionKey='123-123-123-123', dbSubnetGroup='subnet12345', newrelicOrgTag='Platform', newrelicSbuTag='LMB', newrelicLicenseKey='null', clusterEcsRole='plat-role', vpcId='vpc12345', splunkUrl='null'}
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.653 sec
Running com.libertymutualgroup.herman.aws.ecs.PropertyHandlerTest
No property file was loaded - we looked for junit.properties
No property file was loaded - we looked for junit.properties
No property file was loaded - we looked for junit.properties
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.004 sec
Running com.libertymutualgroup.herman.aws.ecs.logging.LoggingServiceTest
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.043 sec
Running com.libertymutualgroup.herman.aws.ecs.broker.dynamodb.DynamoDBConfigTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.124 sec
Running com.libertymutualgroup.herman.aws.ecs.broker.sns.SnsBrokerTest
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.161 sec
Running com.libertymutualgroup.herman.aws.ecs.broker.custom.CustomBrokerTest
No property file was loaded - we looked for test.properties
No property file was loaded - we looked for test.properties
**************************************************************
Custom broker - herman-custom-broker
this is a test description of the custom broker
**************************************************************
Invoking Lambda herman-custom-broker
With payload: {"pushDefinition":{"containerDefinitions":[{"name":null,"image":"543944794056.dkr.ecr.us-east-1.amazonaws.com/my-app:BUILD1","repositoryCredentials":null,"cpu":null,"memory":1900,"memoryReservation":null,"links":[],"portMappings":[{"containerPort":8984,"hostPort":0,"protocol":null}],"essential":null,"entryPoint":[],"command":[],"environment":[{"name":"DEPLOY_ENVIRONMENT","value":"dev"},{"name":"LDAP_PROPS","value":"foo"}],"mountPoints":[{"sourceVolume":"solr-data","containerPath":"/cores","readOnly":null}],"volumesFrom":[],"linuxParameters":null,"secrets":[],"dependsOn":[],"startTimeout":null,"stopTimeout":null,"hostname":null,"user":null,"workingDirectory":null,"disableNetworking":null,"privileged":null,"readonlyRootFilesystem":null,"dnsServers":[],"dnsSearchDomains":[],"extraHosts":[],"dockerSecurityOptions":[],"interactive":null,"pseudoTerminal":null,"dockerLabels":null,"ulimits":[],"logConfiguration":null,"healthCheck":null,"systemControls":[],"resourceRequirements":[],"firelensConfiguration":null}],"cluster":"my-cluster","service":{"instanceCount":1,"deploymentConfiguration":{"maximumPercent":100,"minimumHealthyPercent":0},"urlPrefixOverride":"my-app-dev","urlSuffix":"np-lmb.lmig.com","elbSchemeOverride":null,"urlSchemeOverride":null,"healthCheck":{"target":"/solr/parties/admin/ping","interval":null,"timeout":null,"unhealthyThreshold":null,"healthyThreshold":null},"appStickinessCookie":null,"protocol":null,"elbSourcePorts":null,"healthCheckGracePeriodSeconds":0,"placementConstraints":null,"placementStrategies":null,"schedulingStrategy":"REPLICA"},"appName":"my-app-dev","taskPlacementConstraints":null,"placementStrategies":null,"volumes":[{"name":"solr-data","host":{"sourcePath":"/solr/cores"},"dockerVolumeConfiguration":null,"efsVolumeConfiguration":null}],"networkMode":null,"taskMemory":null,"buckets":null,"streams":null,"queues":null,"topics":null,"dynamoDBTables":null,"database":null,"taskRoleArn":null,"newRelic":null,"notificationWebhook":null,"tags":null,"iamOptOut":null,"useElb":null,"betaAutoscale":null,"iamPolicy":null,"useKms":null,"kmsKeyName":null,"iamRole":null,"albTimeout":null,"ulimits":null,"wafRuleActions":null,"prePushOnly":null,"customBrokers":{"herman-custom-broker":{"var2":"override","var3":"envvarvalue"}},"newRelicApplicationName":null},"clusterMetadata":{"rdsSecurityGroup":null,"appSecurityGroup":null,"elbSecurityGroups":[],"clusterId":null,"elbSubnets":[],"publicSubnets":[],"privateSubnets":[],"clusterCftStackTags":null,"encryptionKey":null,"dbSubnetGroup":null,"newrelicOrgTag":null,"newrelicSbuTag":null,"newrelicLicenseKey":null,"clusterEcsRole":null,"vpcId":null,"splunkUrl":null},"brokerDefinition":{"vpcId":"vpc-1","subnetIds":["subnet-1","subnet-2","subnet-3"],"sbu":"SBU","var1":"test","var2":"override","var3":"envvarvalue"}}
lambda log result
Lambda herman-custom-broker finished
Lambda response: null
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.248 sec
Running com.libertymutualgroup.herman.aws.ecs.broker.rds.OracleClientTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.409 sec
Running com.libertymutualgroup.herman.aws.ecs.broker.rds.AuroraClientTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.037 sec
Running com.libertymutualgroup.herman.aws.ecs.broker.rds.RdsBrokerTest
Tests run: 7, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.159 sec
Running com.libertymutualgroup.herman.aws.ecs.broker.rds.StandardRdsClientTest
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.051 sec

Results :

Tests run: 69, Failures: 0, Errors: 0, Skipped: 0

[INFO] 
[INFO] --- jacoco-maven-plugin:0.8.5:report (report) @ herman ---
[INFO] Loading execution data file /tmp/tmplnr_nmaz/herman/target/jacoco.exec
[INFO] Analyzed bundle 'herman' with 280 classes
[WARNING] Classes in bundle 'herman' do no match with execution data. For report generation the same class files must be used as at runtime.
[WARNING] Execution data for class com/libertymutualgroup/herman/aws/credentials/BambooCredentialsHandler does not match.
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  06:04 min
[INFO] Finished at: 2020-07-30T20:33:26Z
[INFO] ------------------------------------------------------------------------
