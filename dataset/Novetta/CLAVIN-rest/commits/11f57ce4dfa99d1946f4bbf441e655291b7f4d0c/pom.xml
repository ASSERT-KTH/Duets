<project
	xmlns="http://maven.apache.org/POM/4.0.0"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
	<modelVersion>4.0.0</modelVersion>
	<groupId>com.novetta</groupId>
	<artifactId>clavin-rest</artifactId>
	<version>1.0.0</version>
	<packaging>jar</packaging>
	<name>clavin-rest</name>
	<url>http://maven.apache.org</url>
	<parent>
		<groupId>org.springframework.boot</groupId>
		<artifactId>spring-boot-starter-parent</artifactId>
		<version>2.3.5.RELEASE</version>
		<relativePath/>
	</parent>

	<dependencies>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter</artifactId>
		</dependency>
		<dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-web</artifactId>
        </dependency>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-test</artifactId>
			<scope>test</scope>
		</dependency>
		<dependency>
		  	<groupId>com.novetta</groupId>
		  	<artifactId>CLAVIN</artifactId>
		  	<version>3.0.0</version>
		</dependency>
	</dependencies>
	
	 <repositories>
    	<repository>
      		<id>ossrh</id>
      		<url>http://oss.sonatype.org/content/repositories/snapshots</url>
      		<releases>
        		<enabled>false</enabled>
      		</releases>
      		<snapshots>
        		<enabled>true</enabled>
      		</snapshots>
    	</repository>
 	</repositories>
	
	<reporting>
		<plugins>
	      	<plugin>
		        <groupId>org.apache.maven.plugins</groupId>
		        <artifactId>maven-project-info-reports-plugin</artifactId>
		        <version>3.1.1</version>
		    </plugin>
			<plugin>
				<groupId>org.apache.maven.plugins</groupId>
				<artifactId>maven-jxr-plugin</artifactId>
				<version>3.0.0</version>
			</plugin>
			<plugin>
				<groupId>org.apache.maven.plugins</groupId>
				<artifactId>maven-pmd-plugin</artifactId>
				<configuration>
					<includeTests>true</includeTests>
				</configuration>
			</plugin>
			<plugin>
				<groupId>org.codehaus.mojo</groupId>
				<artifactId>taglist-maven-plugin</artifactId>
				<version>2.4</version>
			</plugin>
			 
			<plugin>
				<groupId>org.apache.maven.plugins</groupId>
				<artifactId>maven-javadoc-plugin</artifactId>
				<version>3.2.0</version>
				<configuration>
					<doclint>none</doclint>
				</configuration>
			</plugin>
			<plugin>
				<groupId>org.codehaus.mojo</groupId>
				<artifactId>versions-maven-plugin</artifactId>
				<version>2.8.1</version>
				<reportSets>
					<reportSet>
						<reports>
							<report>dependency-updates-report</report>
							<report>plugin-updates-report</report>
							<report>property-updates-report</report>
						</reports>
					</reportSet>
				</reportSets>
			</plugin>
		</plugins>
	</reporting>
	
	<properties>
	   <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
	   <project.reporting.outputEncoding>UTF-8</project.reporting.outputEncoding>
	   <maven.compile.encoding>UTF-8</maven.compile.encoding>
	   <java.version>14</java.version>
	   <maven.compiler.source>${java.version}</maven.compiler.source>
	   <maven.compiler.target>${java.version}</maven.compiler.target>
	   <pmd.plugin.version>3.13.0</pmd.plugin.version>
	   <dockerfile-maven-version>1.4.13</dockerfile-maven-version>
	</properties>
		
	<build>
	    <pluginManagement>
            <plugins>
                <plugin>
                    <groupId>org.apache.maven.plugins</groupId>
                    <artifactId>maven-pmd-plugin</artifactId>
                    <version>${pmd.plugin.version}</version>
                </plugin>
            </plugins>
        </pluginManagement>
		<plugins>
			<plugin>
				<groupId>org.apache.maven.plugins</groupId>
				<artifactId>maven-surefire-plugin</artifactId>
				<version>3.0.0-M5</version>
				<configuration>
				    <forkCount>3</forkCount>
        			<reuseForks>true</reuseForks>
					<argLine>-Xmx2g</argLine>
				</configuration>
			</plugin>	
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-failsafe-plugin</artifactId>
                <version>3.0.0-M5</version>
			</plugin>
			<plugin>
				<groupId>org.springframework.boot</groupId>
				<artifactId>spring-boot-maven-plugin</artifactId>
				<executions>
		            <execution>
			            <id>pre-integration-test</id>
			            <goals>
			              <goal>start</goal>
			            </goals>
			            <configuration>
			              <skip>false</skip>
			            </configuration>
  		            </execution>
	                <execution>
	                    <id>repackage</id>
	                    <goals>
	                        <goal>repackage</goal>
	                    </goals>
	                    <configuration>
	                        <finalName>clavin-rest</finalName>
	                    </configuration>
	                </execution>
	            </executions>
			</plugin>
			<plugin>
				<groupId>org.apache.maven.plugins</groupId>
				<artifactId>maven-project-info-reports-plugin</artifactId>
				<version>3.1.1</version>
			</plugin>
			<plugin>
				<groupId>org.apache.maven.plugins</groupId>
				<artifactId>maven-site-plugin</artifactId>
				<version>3.9.1</version>
			</plugin>
			<plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-pmd-plugin</artifactId>
                <configuration>
                    <!-- failOnViolation is actually true by default, but can be disabled -->
                    <failOnViolation>false</failOnViolation>
                    <!-- printFailingErrors is pretty useful -->
                    <printFailingErrors>true</printFailingErrors>
                    <targetJdk>14</targetJdk>
                </configuration>
                <executions>
                    <execution>
                        <goals>
                            <goal>check</goal>
                        </goals>
                    </execution>
                </executions>

                <dependencies>
                    <!-- https://mvnrepository.com/artifact/net.sourceforge.pmd/pmd-java -->
                    <dependency>
                        <groupId>net.sourceforge.pmd</groupId>
                        <artifactId>pmd-java</artifactId>
                        <version>6.23.0</version>
                    </dependency>

                    <!-- https://mvnrepository.com/artifact/net.sourceforge.pmd/pmd-core -->
                    <dependency>
                        <groupId>net.sourceforge.pmd</groupId>
                        <artifactId>pmd-core</artifactId>
                        <version>6.23.0</version>
                    </dependency>
                </dependencies>
            </plugin>
            <plugin>
        		<groupId>com.spotify</groupId>
        		<artifactId>dockerfile-maven-plugin</artifactId>
        		<version>${dockerfile-maven-version}</version>
	            <executions>
	                <execution>
	                    <id>tag-latest</id>
	                    <goals>
	                        <goal>push</goal>
	                    </goals>
	                    <configuration>
	                        <tag>latest</tag>
	                    </configuration>
	                </execution>
	                <execution>
	                    <id>tag-version</id>
	                    <goals>
	                        <goal>push</goal>
	                    </goals>
	                    <configuration>
	                        <tag>${project.version}</tag>
	                    </configuration>
	                </execution>
   	            </executions>
	            <configuration>
		            <repository>${project.artifactId}</repository>
		            <buildArgs>
	    	            <JAR_FILE>target/${project.build.finalName}.jar</JAR_FILE>
	                </buildArgs>
	        	    <contextDirectory>${basedir}</contextDirectory>
	            	<dockerfile>Dockerfile</dockerfile>
	              	<noCache>true</noCache>
               	</configuration>
	   		</plugin>
		</plugins>
	</build>
</project>
